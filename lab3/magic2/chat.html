<html>
<head>
    <title>-={ AGH web sec | Srog the Ugly }=-</title>
    <meta charset="utf-8">
    <link rel="stylesheet" href="{{.UrlBase}}/assets/lab3.css">
    <script type="text/javascript" src="{{.UrlBase}}/assets/lab3.js" ></script>
</head>

<body bgcolor="black">
    <div id="channelText"></div>

    <div id="nicksFrame"></div>

    <div id="inputUserDiv">
        <script>
        function typeText(){
            var command = document.getElementById('inputUser').value
            if (command.startsWith('/nick ')) {
                if (command.split(' ').length == 2 && command.split(' ')[1].length > 2) {
                    var newNick = command.split(' ')[1]
                    insertText('* nick set up correctly')
                    insertText('Welcome ' + newNick)
                    setNick(newNick)
                } else {
                    insertText('* bad command')
                    insertText('* maybe use: /nick newNickName')
                    insertText('* newNickName.length > 2')
                }
            } else {
                insertText(command, nick=-1, send=true, date=null);
            }
            var conversationPanel = document.getElementById("channelText");
            conversationPanel.scrollTop = conversationPanel.scrollHeight;
        }
        </script>

        <form action="javascript:typeText();">
            <input type="text" id="inputUser" name="input" autocomplete=off class="inputText" STYLE="color: #00E900; font-family: fixedsys, consolas, monospace; font-size: 16px; background-color: black;" size="12" maxlength="100">
            <br>
            <script>document.getElementById("inputUser").focus();</script>
        </form>
    </div>

    <script type="text/javascript">
        startChat();
    </script>

</body>
</html>
