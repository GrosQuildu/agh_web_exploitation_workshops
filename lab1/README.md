# To download
* SwitchyOmega or SwitchyProxy or similar
* burp and/or zap (links up)
* curl
* dirbuster and/or gobuster (links up)
* wappalyzer
* docker

# To read
* Bash Scripting: https://linuxconfig.org/bash-scripting-tutorial-for-beginners
* Python basics: https://python101.readthedocs.io/pl/latest/podstawy/index.html
* Model-View-Controller (MVC): https://realpython.com/the-model-view-controller-mvc-paradigm-summarized-with-legos/
* HTTP basics: https://sekurak.pl/protokol-http-podstawy/
* Dockera basics: https://infra.knbit.edu.pl/03-docker/

# lab setup
* local:
* remote at: [aghws.jctf.pl](https://aghws.jctf.pl/lab1)

# The content

### HTTP crash course ([presentation here]())
* __TODO: read about stuff in presentation__
* how it looks like
* urls and resources
* methods and response codes
* headers, cookies, params
* content types and encodings
* dev console

### Local proxy
* __TODO: setup the burp__
* how do we catch requests
* [burp](https://portswigger.net/burp)
* [zap](https://www.zaproxy.org/)

### Encoding
* __TODO: go to https://aghws.jctf.pl/lab1/strange-... somehow__
    ```python
    @app.route('/strange-!?"#$%&\'()*+,-./:;/<string:t1>')
    def strange(t1):
        is_ok = True

        t1 = unquote(t1)
        if t1 != '!?"#$%&\'()*+,-./:;':
            is_ok = False

        if 't2=' not in request.args or request.args['t2='] != ';:/.-,+*)(\'&%$#"?!<>':
            is_ok = False

        if is_ok:
            return 'Ok, you made it'
        else:
            return 'Nope'
    ```
#### Tips
* run the code locally
* complete the challenge step by step - first get to the valid route, then one param, then another
* make debug prints in the code to uderstand what is wrong

* solution: ```/lab1/strange-!%3f"%23$%25&'()*+,-./:;/%21%3f%22%23%24%25%26%27%28%29%2a%2b%2c%2d%2e%25%32%66%3a%3b?t2%3d=%3b%3a%2f%2e%2d%2c%2b%2a%29%28%27%26%25%24%23%22%3f%21%3c%3```


### bruting & recon - wappalyzer, curl
* __TODO: find what language/server the app uses__ 
* __TODO: didn't have time at the lab, but checkout `curl` tool and use it for bruteforcing__
* [curl](https://curl.haxx.se/)
* seclists
    * [wordpress](https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/URLs/urls-wordpress-3.3.1.txt)
    * [py](https://raw.githubusercontent.com/danielmiessler/SecLists/c196a6e62d0b63d6be0c84e6fa224352ea5949df/Discovery/Web-Content/SVNDigger/cat/Language/py.txt)
    * [pycache](https://raw.githubusercontent.com/danielmiessler/SecLists/2dd253e2dbd2fe10acaaa4e67668289d05d31761/Fuzzing/fuzz-Bo0oM.txt)

### bruting & IDOR - busters
* __TODO: use gobuster for the lab task__
* [dirbuster](https://sourceforge.net/projects/dirbuster/)
* [gobuster](https://github.com/OJ/gobuster)

### python & IDOR - busting with automation
* __TODO: use python for next lab task__
```python
def randomFlag():
    folder = random.randint(1, 155)
    new_dir = './app/static/{}'.format(folder)
    if not os.path.isdir(new_dir):
        os.mkdir(new_dir)
        shutil.copyfile('/tmp/suspicious_file.txt', os.path.join(new_dir, 'suspicious_file.txt'))
```
Zadanie z IDOR'em w blogpostach do uzupe≈Çnienia:
```python
import requests
from urllib import parse
import base64
import re
from sys import exit


def decode_id(id):
    # TODO decode URL
    res =
    # TODO decode Base64
    res =
    # convert from bytes to string
    res = res.decode('utf-8')
    # TODO convert to decimal from hex
    res =
    return res

def encode_id(id):
    # TODO convert form decimal to hex
    res =
    res = res.encode('utf-8')
    # TODO base64 encode
    res =
    res = res.decode('utf-8')
    res = parse.quote_plus(res)
    return str(res)

def request_blogpost(id):
    encoded_id = encode_id(id)
    # Use python3.7 to use f-strings
    url = f'https://aghws.jctf.pl/lab1/{encoded_id}'
    # TODO use your session cookie
    resp = requests.get(url, cookies={'session': })
    flag = re.search(r'jctf\{.*\}', resp.text)
    if flag:
        print(url)
        print(flag.group())
        exit(0)


if __name__ == '__main__':
    # TODO put your post id
    my_post_id =
    my_post_id_decimal = decode_id(my_post_id)
    for i in range(1000):
        request_blogpost(my_post_id_decimal + i)
        request_blogpost(my_post_id_decimal - i)

```
