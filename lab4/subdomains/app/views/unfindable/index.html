<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Welcome file</title>
  <link rel="stylesheet" href="https://stackedit.io/style.css" />
</head>

<body class="stackedit">
  <div class="stackedit__html"><h1 id="unfindable-page">Unfindable page</h1>
<p>No one is ever finding this domain. Thus, we can safely store parts of the application source code here.</p>
<h5 id="configroutes.rb">config/routes.rb</h5>
<pre class=" language-ruby"><code class="prism  language-ruby"><span class="token comment"># route http://localhost:3000/grant_privileges</span>
match <span class="token string">"/grant_privileges"</span><span class="token punctuation">,</span>
	<span class="token symbol">:to</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">"privileges#grant"</span><span class="token punctuation">,</span>
	<span class="token symbol">:via</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token string">"get"</span><span class="token punctuation">,</span> <span class="token string">"post"</span><span class="token punctuation">]</span>
</code></pre>
<h5 id="appcontrollersprivileges_controller.rb">app/controllers/privileges_controller.rb</h5>
<pre class=" language-ruby"><code class="prism  language-ruby"><span class="token keyword">class</span> <span class="token class-name">PrivilegesController</span> <span class="token operator">&lt;</span> <span class="token constant">ApplicationController</span>
    protect_from_forgery except<span class="token punctuation">:</span> <span class="token symbol">:index</span>
    <span class="token keyword">def</span> grant
        <span class="token keyword">if</span> request<span class="token punctuation">.</span>get<span class="token operator">?</span>
            <span class="token comment"># if the method is GET, only show the info</span>
            <span class="token variable">@info</span> <span class="token operator">=</span> <span class="token string">"send POST to this endpoint to grant privileges"</span>
        <span class="token keyword">else</span>
            <span class="token comment"># if request method is POST</span>
            <span class="token comment"># surely requests with other methods won't get in here</span>
            email <span class="token operator">=</span> request<span class="token punctuation">.</span>params<span class="token punctuation">[</span><span class="token symbol">:email</span><span class="token punctuation">]</span>
            <span class="token variable">@user</span> <span class="token operator">=</span> <span class="token constant">User</span><span class="token punctuation">.</span><span class="token function">find_by</span><span class="token punctuation">(</span><span class="token symbol">:email</span> <span class="token operator">=</span><span class="token operator">&gt;</span> email<span class="token punctuation">)</span>
            <span class="token variable">@user</span><span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token symbol">:admin</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token keyword">true</span><span class="token punctuation">)</span>
        <span class="token keyword">end</span>
    <span class="token keyword">end</span>
<span class="token keyword">end</span>
</code></pre>
</div>
</body>

</html>
