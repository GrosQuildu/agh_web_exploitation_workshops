require 'httparty'

class SsrfController < ApplicationController
    layout false
    protect_from_forgery
    def index
        
    end

    def make_request
        url = request.params[:url]
        method = request.params[:method]
        if method == 'get'
            resp = HTTParty.get(url)
            flash[:notice] = "Request sent, response code: #{resp.code}"
            redirect_to :controller => 'home', :action => 'index'
        elsif method == 'head'
            resp = HTTParty.head(url)
            flash[:notice] = "Request sent, response code: #{resp.code}"
            redirect_to :controller => 'home', :action => 'index'
        else
            flash[:alert] = "only GET and HEAD request methods are allowed"
            redirect_to :controller => 'home', :action => 'index'
        end
    end
end
